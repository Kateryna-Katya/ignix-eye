{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () => {\n\n  // --- 1. Инициализация иконок (Lucide) ---\n  if (typeof lucide !== 'undefined') {\n      lucide.createIcons();\n  } else {\n      console.warn('Lucide Icons library not found');\n  }\n\n  // --- 2. Плавный скролл (Lenis) ---\n  // Проверка на существование библиотеки\n  if (typeof Lenis !== 'undefined') {\n      const lenis = new Lenis({\n          duration: 1.2,\n          easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),\n          direction: 'vertical',\n          smooth: true\n      });\n\n      function raf(time) {\n          lenis.raf(time);\n          requestAnimationFrame(raf);\n      }\n      requestAnimationFrame(raf);\n  }\n\n  // --- 3. Мобильное меню ---\n  const burger = document.querySelector('.header__burger');\n  const mobileMenu = document.querySelector('.mobile-menu');\n  const mobileLinks = document.querySelectorAll('.mobile-menu__link');\n\n  if (burger && mobileMenu) {\n      const toggleMenu = () => {\n          mobileMenu.classList.toggle('is-active');\n          burger.classList.toggle('is-active');\n\n          const lines = burger.querySelectorAll('.header__burger-line');\n          if (mobileMenu.classList.contains('is-active')) {\n              lines[0].style.transform = 'rotate(45deg) translate(5px, 5px)';\n              lines[1].style.transform = 'rotate(-45deg) translate(5px, -5px)';\n          } else {\n              lines[0].style.transform = 'none';\n              lines[1].style.transform = 'none';\n          }\n      };\n\n      burger.addEventListener('click', toggleMenu);\n      mobileLinks.forEach(link => link.addEventListener('click', toggleMenu));\n  }\n\n  // --- 4. Хедер при скролле ---\n  const header = document.querySelector('.header');\n  if (header) {\n      window.addEventListener('scroll', () => {\n          if (window.scrollY > 50) {\n              header.style.background = 'rgba(11, 12, 16, 0.95)';\n              header.style.boxShadow = '0 4px 20px rgba(0,0,0,0.3)';\n          } else {\n              header.style.background = 'rgba(11, 12, 16, 0.85)';\n              header.style.boxShadow = 'none';\n          }\n      });\n  }\n\n  // --- 5. Анимации GSAP (Основное исправление) ---\n  if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {\n      gsap.registerPlugin(ScrollTrigger);\n\n      // Анимация заголовков (SplitType) с проверкой\n      if (typeof SplitType !== 'undefined') {\n          const splitTypes = document.querySelectorAll('.reveal-text');\n          splitTypes.forEach((char) => {\n              const text = new SplitType(char, { types: 'chars' });\n              gsap.from(text.chars, {\n                  scrollTrigger: {\n                      trigger: char,\n                      start: 'top 85%',\n                      toggleActions: 'play none none reverse'\n                  },\n                  y: 50,\n                  opacity: 0,\n                  stagger: 0.02,\n                  duration: 0.8,\n                  ease: 'back.out(1.7)'\n              });\n          });\n      }\n\n      // Простое появление (Fade In)\n      const fadeElements = document.querySelectorAll('.fade-in');\n      fadeElements.forEach(el => {\n          gsap.fromTo(el,\n              { opacity: 0, y: 30 },\n              {\n                  opacity: 1,\n                  y: 0,\n                  duration: 1,\n                  ease: 'power3.out',\n                  scrollTrigger: {\n                      trigger: el,\n                      start: 'top 90%',\n                  }\n              }\n          );\n      });\n\n      // ИСПРАВЛЕНИЕ: Пакетная анимация для карточек (.fade-in-up)\n      // Вместо forEach используем batch, чтобы гарантировать запуск для всех\n      ScrollTrigger.batch(\".fade-in-up\", {\n          onEnter: batch => {\n              gsap.to(batch, {\n                  opacity: 1,\n                  y: 0,\n                  stagger: 0.15, // Задержка между появлением элементов\n                  duration: 0.8,\n                  ease: \"power2.out\",\n                  overwrite: true\n              });\n          },\n          // Начальное состояние задаем здесь, чтобы они не были видны до скролла\n          onRefresh: batch => {\n              gsap.set(batch, { opacity: 0, y: 50 });\n          }\n      });\n\n      // Принудительно скрываем элементы перед началом анимации\n      gsap.set(\".fade-in-up\", { opacity: 0, y: 50 });\n\n  } else {\n      console.error('GSAP or ScrollTrigger not loaded');\n  }\n\n  // --- 6. Форма и Валидация ---\n  const form = document.getElementById('consultationForm');\n  if (form) {\n      const phoneInput = document.getElementById('phone');\n      const captchaTask = document.getElementById('captcha-task');\n      const captchaInput = document.getElementById('captcha-input');\n      const captchaError = document.getElementById('captcha-error');\n      const formStatus = document.getElementById('formStatus');\n\n      // Только цифры\n      phoneInput.addEventListener('input', (e) => {\n          e.target.value = e.target.value.replace(/[^0-9+]/g, '');\n      });\n\n      // Капча\n      let num1 = Math.floor(Math.random() * 10) + 1;\n      let num2 = Math.floor(Math.random() * 10) + 1;\n      let captchaResult = num1 + num2;\n      if (captchaTask) captchaTask.textContent = `${num1} + ${num2} = ?`;\n\n      form.addEventListener('submit', (e) => {\n          e.preventDefault();\n          let isValid = true;\n\n          // Валидация пустых полей\n          const inputs = form.querySelectorAll('input[required]');\n          inputs.forEach(input => {\n              const group = input.closest('.form-group');\n              if (!input.value.trim()) {\n                  if (group) group.classList.add('error');\n                  isValid = false;\n              } else {\n                  if (group) group.classList.remove('error');\n              }\n          });\n\n          // Проверка капчи\n          if (parseInt(captchaInput.value) !== captchaResult) {\n              const group = captchaInput.closest('.form-group');\n              if (group) group.classList.add('error');\n              if (captchaError) captchaError.style.display = 'block';\n              isValid = false;\n          } else {\n              const group = captchaInput.closest('.form-group');\n              if (group) group.classList.remove('error');\n              if (captchaError) captchaError.style.display = 'none';\n          }\n\n          if (isValid) {\n              const btn = form.querySelector('button[type=\"submit\"]');\n              const oldText = btn.textContent;\n              btn.textContent = 'Отправка...';\n              btn.disabled = true;\n\n              setTimeout(() => {\n                  form.style.display = 'none';\n                  if (formStatus) {\n                      formStatus.style.display = 'flex';\n                      formStatus.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                  }\n              }, 1500);\n          }\n      });\n  }\n\n  // --- 7. Cookies ---\n  const cookiePopup = document.getElementById('cookiePopup');\n  const acceptBtn = document.getElementById('acceptCookies');\n\n  if (cookiePopup && acceptBtn) {\n      if (!localStorage.getItem('cookiesAccepted')) {\n          setTimeout(() => {\n              cookiePopup.classList.add('show');\n          }, 2000);\n      }\n\n      acceptBtn.addEventListener('click', () => {\n          localStorage.setItem('cookiesAccepted', 'true');\n          cookiePopup.classList.remove('show');\n      });\n  }\n});\n\n// Дополнительный пересчет скролла после полной загрузки страницы (картинок и шрифтов)\nwindow.addEventListener('load', () => {\n  if (typeof ScrollTrigger !== 'undefined') {\n      ScrollTrigger.refresh();\n  }\n});"],"names":["raf","time","lenis","t","burger","mobileMenu","mobileLinks","toggleMenu","lines","link","header","char","text","el","batch","form","phoneInput","captchaTask","captchaInput","captchaError","formStatus","e","num1","num2","captchaResult","isValid","input","group","btn","cookiePopup","acceptBtn"],"mappings":"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"}